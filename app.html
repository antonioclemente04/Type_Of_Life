<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Type of Life</title>
<style>
/* --- ESTILOS BASE --- */
@font-face {
  font-family: "TipografaViva";
  src: url("Tipografía final-VF.ttf") format("truetype");
}

:root {
  --bg-color: #f5f5f5;
  --surface-color: #ffffff;
  --text-main: #1a1a1a;
  --text-muted: #666;
  --accent: #2c3e50;
  --border: #e0e0e0;
}

body {
  font-family: system-ui, -apple-system, sans-serif;
  margin: 0;
  padding: 0;
  height: 100vh;
  width: 100vw;
  overflow: hidden;
  display: grid;
  grid-template-columns: 450px 1fr;
  background-color: var(--bg-color);
  background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
  background-size: 24px 24px;
  color: var(--text-main);
}

/* --- PANEL TIPO "WIZARD" --- */
.panel-container {
  background: var(--surface-color);
  height: 100vh;
  display: flex;
  flex-direction: column;
  box-shadow: 10px 0 30px rgba(0,0,0,0.05);
  border-right: 1px solid var(--border);
  position: relative;
  z-index: 10;
}

.progress-bar-container {
  width: 100%;
  height: 6px;
  background: #f0f0f0;
  flex-shrink: 0;
}
.progress-bar {
  height: 100%;
  background: var(--accent);
  width: 25%;
  transition: width 0.4s ease;
}

.wizard-content {
  flex: 1;
  padding: 2rem 2.5rem;
  display: flex;
  flex-direction: column;
  justify-content: flex-start; 
  overflow-y: auto;
  overflow-x: hidden;
}

.step-header { margin-bottom: 1.5rem; flex-shrink: 0; }
.step-counter {
  font-size: 0.75rem; text-transform: uppercase; letter-spacing: 2px;
  color: var(--text-muted); font-weight: bold; display: block; margin-bottom: 0.25rem;
}
.step-title { font-size: 1.5rem; margin: 0; color: var(--text-main); }
.step-desc { color: var(--text-muted); margin-top: 0.25rem; font-size: 0.9rem; line-height: 1.3; }

.step { display: none; animation: fadeIn 0.4s ease; padding-bottom: 1rem; }
.step.active { display: block; }

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.input-group { margin-bottom: 1.2rem; }
label { display: block; font-weight: 600; margin-bottom: 0.5rem; font-size: 0.85rem; color: var(--text-main); }

input[type="text"], select {
  width: 100%; padding: 0.8rem; font-size: 1rem;
  border: 1px solid #ccc; border-radius: 0.6rem;
  background: #f9f9f9; transition: all 0.2s; box-sizing: border-box;
}
input[type="text"]:focus, select:focus {
  border-color: var(--accent); background: white; outline: none;
}

.options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
.option-card { position: relative; cursor: pointer; }
.option-card input { position: absolute; opacity: 0; width: 0; height: 0; }
.card-content {
  display: flex; align-items: center; justify-content: center;
  padding: 0.6rem 0.2rem; background: #fff;
  border: 1px solid #ddd; border-radius: 0.6rem;
  text-align: center; font-size: 0.85rem; color: #555;
  transition: all 0.2s; min-height: 40px;
}
.option-card:hover .card-content { border-color: #999; background: #fafafa; }
.option-card input:checked + .card-content {
  background: var(--accent); color: white;
  border-color: var(--accent); font-weight: 600;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.wizard-nav {
  padding: 1.5rem 2.5rem; border-top: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
  background: var(--surface-color); flex-shrink: 0; z-index: 20;
}

.btn {
  padding: 0.8rem 1.8rem; border-radius: 50px; font-weight: 600;
  cursor: pointer; transition: all 0.3s; border: none; font-size: 0.95rem;
}
.btn-prev { background: transparent; color: var(--text-muted); }
.btn-prev:hover { color: var(--text-main); background: #f0f0f0; }
.btn-prev:disabled { opacity: 0.3; cursor: not-allowed; }
.btn-next { background: var(--accent); color: white; }
.btn-next:hover { background: #1a252f; transform: translateY(-1px); }

/* --- PREVIEW AREA --- */
.preview-area {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2rem;
  overflow: hidden;
}

.preview-card {
  font-family: "TipografaViva", system-ui, sans-serif;
  font-size: clamp(2.5rem, 7vw, 8rem); 
  line-height: 1;
  background: transparent;
  border: none;
  box-shadow: none;
  padding: 0;
  text-align: center;
  width: 100%;
  max-width: 900px;
}

/* --- GLITCH CSS (Restaurado al original funcional) --- */
.glitch-wrapper {
  position: relative;
  display: inline-block;
}
.glitch-wrapper.active {
  animation: glitch-skew 0.5s infinite;
}

/* Keyframes originales */
@keyframes glitch-skew {
  0% { transform: skewX(0deg); }
  10% { transform: skewX(-2deg); }
  20% { transform: skewX(2deg); }
  30% { transform: skewX(-1deg); }
  40% { transform: skewX(1deg); }
  50% { transform: skewX(0deg); }
  60% { transform: skewX(-1deg); }
  70% { transform: skewX(1deg); }
  80% { transform: skewX(-0.5deg); }
  90% { transform: skewX(0.5deg); }
  100% { transform: skewX(0deg); }
}

.glitch-wrapper::before,
.glitch-wrapper::after {
  content: attr(data-text);
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  /* IMPORTANTE: Color de fondo igual al body para que el recorte funcione */
  background: var(--bg-color); 
}

/* Polígonos de recorte originales */
.glitch-level-1::before { clip-path: polygon(0 0,100% 0,100% 35%,0 35%,0 40%,100% 40%,100% 100%,0 100%); animation: glitch-1-before 0.4s infinite; }
.glitch-level-1::after { clip-path: polygon(0 0,100% 0,100% 60%,0 60%,0 65%,100% 65%,100% 100%,0 100%); animation: glitch-1-after 0.35s infinite; }
@keyframes glitch-1-before { 0%{transform:translate(0,0);} 20%{transform:translate(-3px,-2px);} 40%{transform:translate(3px,2px);} 60%{transform:translate(-2px,1px);} 80%{transform:translate(2px,-1px);} 100%{transform:translate(0,0);} }
@keyframes glitch-1-after { 0%{transform:translate(0,0);} 20%{transform:translate(3px,2px);} 40%{transform:translate(-3px,-2px);} 60%{transform:translate(2px,-1px);} 80%{transform:translate(-2px,1px);} 100%{transform:translate(0,0);} }

.glitch-level-2::before { clip-path: polygon(0 0,100% 0,100% 25%,0 25%,0 30%,100% 30%,100% 55%,0 55%,0 60%,100% 60%,100% 100%,0 100%); animation: glitch-2-before 0.3s infinite; }
.glitch-level-2::after { clip-path: polygon(0 0,100% 0,100% 40%,0 40%,0 45%,100% 45%,100% 70%,0 70%,0 75%,100% 75%,100% 100%,0 100%); animation: glitch-2-after 0.25s infinite; }
@keyframes glitch-2-before { 0%{transform:translate(0,0);} 15%{transform:translate(-5px,-3px);} 30%{transform:translate(5px,3px);} 45%{transform:translate(-4px,2px);} 60%{transform:translate(4px,-2px);} 75%{transform:translate(-3px,1px);} 90%{transform:translate(3px,-1px);} 100%{transform:translate(0,0);} }
@keyframes glitch-2-after { 0%{transform:translate(0,0);} 15%{transform:translate(5px,3px);} 30%{transform:translate(-5px,-3px);} 45%{transform:translate(4px,-2px);} 60%{transform:translate(-4px,2px);} 75%{transform:translate(3px,-1px);} 90%{transform:translate(-3px,1px);} 100%{transform:translate(0,0);} }

.glitch-level-3::before { clip-path: polygon(0 0,100% 0,100% 15%,0 15%,0 20%,100% 20%,100% 35%,0 35%,0 40%,100% 40%,100% 55%,0 55%,0 60%,100% 60%,100% 75%,0 75%,0 80%,100% 80%,100% 100%,0 100%); animation: glitch-3-before 0.2s infinite; }
.glitch-level-3::after { clip-path: polygon(0 0,100% 0,100% 25%,0 25%,0 30%,100% 30%,100% 45%,0 45%,0 50%,100% 50%,100% 65%,0 65%,0 70%,100% 70%,100% 85%,0 85%,0 90%,100% 90%,100% 100%,0 100%); animation: glitch-3-after 0.15s infinite; }
@keyframes glitch-3-before { 0%{transform:translate(0,0);} 10%{transform:translate(-7px,-4px);} 20%{transform:translate(7px,4px);} 30%{transform:translate(-6px,3px);} 40%{transform:translate(6px,-3px);} 50%{transform:translate(-5px,2px);} 60%{transform:translate(5px,-2px);} 70%{transform:translate(-4px,1px);} 80%{transform:translate(4px,-1px);} 90%{transform:translate(-3px,2px);} 100%{transform:translate(0,0);} }
@keyframes glitch-3-after { 0%{transform:translate(0,0);} 10%{transform:translate(7px,4px);} 20%{transform:translate(-7px,-4px);} 30%{transform:translate(6px,-3px);} 40%{transform:translate(-6px,3px);} 50%{transform:translate(5px,-2px);} 60%{transform:translate(-5px,2px);} 70%{transform:translate(4px,-1px);} 80%{transform:translate(-4px,1px);} 90%{transform:translate(3px,-2px);} 100%{transform:translate(0,0);} }

@media (max-width: 900px) {
    body { grid-template-columns: 1fr; overflow: auto; display: block; height: auto; }
    .panel-container { height: auto; min-height: 80vh; border-right: none; }
    .wizard-content { max-height: 60vh; }
    .preview-area { padding: 2rem; min-height: 50vh; }
}
</style>
</head>
<body>

<div class="panel-container">
  <div class="progress-bar-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div class="wizard-content">
    
    <div class="step active" id="step1">
      <div class="step-header">
        <span class="step-counter">Fase 01 / 04</span>
        <h2 class="step-title">Identidad del Sujeto</h2>
        <p class="step-desc">Escribe tu nombre para comenzar con la simulación.</p>
      </div>
      <div class="input-group">
        <label>Nombre</label>
        <input type="text" id="nameInput" placeholder="Escribe aquí..." autocomplete="off">
      </div>
    </div>

    <div class="step" id="step2">
      <div class="step-header">
        <span class="step-counter">Fase 02 / 04</span>
        <h2 class="step-title">Hábitos Físicos</h2>
        <p class="step-desc">Existen hábitos que afectan objetivamente a la salud desde nuestras propias acciones.</p>
      </div>
      
      <div class="input-group">
        <label>Nivel de Actividad</label>
        <div class="options-grid">
          <label class="option-card"><input type="radio" name="exercise" value="0" checked><span class="card-content">Atleta</span></label>
          <label class="option-card"><input type="radio" name="exercise" value="100"><span class="card-content">Moderado</span></label>
          <label class="option-card"><input type="radio" name="exercise" value="200"><span class="card-content">Sedentario</span></label>
          <label class="option-card"><input type="radio" name="exercise" value="300"><span class="card-content">Inactivo</span></label>
        </div>
      </div>

      <div class="input-group">
        <label>Calidad del Sueño</label>
        <div class="options-grid">
            <label class="option-card"><input type="radio" name="sleep" value="0" checked><span class="card-content">8+ Horas</span></label>
            <label class="option-card"><input type="radio" name="sleep" value="50"><span class="card-content">6-7 h</span></label>
            <label class="option-card"><input type="radio" name="sleep" value="100"><span class="card-content">5 h</span></label>
            <label class="option-card"><input type="radio" name="sleep" value="200"><span class="card-content">Insomnio</span></label>
        </div>
      </div>

      <div class="input-group">
        <label>Hábitos Nocivos (Tabaco)</label>
        <div class="options-grid">
            <label class="option-card"><input type="radio" name="smoke" value="0" checked><span class="card-content">No Fumo</span></label>
            <label class="option-card"><input type="radio" name="smoke" value="50"><span class="card-content">Ocasional</span></label>
            <label class="option-card"><input type="radio" name="smoke" value="100"><span class="card-content">Habitual</span></label>
            <label class="option-card"><input type="radio" name="smoke" value="200"><span class="card-content">Intenso</span></label>
        </div>
      </div>
    </div>

    <div class="step" id="step3">
      <div class="step-header">
        <span class="step-counter">Fase 03 / 04</span>
        <h2 class="step-title">Factores del Entorno</h2>
        <p class="step-desc">El ambiente donde resides y tus oportunidades también afectan a tu salud .</p>
      </div>

      <div class="input-group">
        <label>Ciudad de Residencia</label>
        <select id="citySelect" name="city">
          <option value="">Selecciona...</option>
          <option value="Madrid,ES">Madrid (ES)</option>
          <option value="Barcelona,ES">Barcelona (ES)</option>
          <option value="London,GB">Londres (UK)</option>
          <option value="New York,US">New York (US)</option>
          <option value="Tokyo,JP">Tokyo (JP)</option>
          <option value="Beijing,CN">Beijing (CN)</option>
          <option value="Mumbai,IN">Mumbai (IN)</option>
          <option value="Oslo,NO">Oslo (NO)</option>
        </select>
        <small id="airQualityInfo" style="display:block; margin-top:5px; color:#3498db;"></small>
      </div>

      <div class="input-group">
        <label>Clima</label>
        <div class="options-grid">
            <label class="option-card"><input type="radio" name="temp" value="0" checked><span class="card-content">Agradable</span></label>
            <label class="option-card"><input type="radio" name="temp" value="0.5"><span class="card-content">Extremo</span></label>
        </div>
      </div>

      <div class="input-group">
        <label>Acceso a Agua</label>
        <div class="options-grid">
            <label class="option-card"><input type="radio" name="water" value="0" checked><span class="card-content">Potable</span></label>
            <label class="option-card"><input type="radio" name="water" value="0.5"><span class="card-content">Escasa/Mala</span></label>
        </div>
      </div>
    </div>

    <div class="step" id="step4">
      <div class="step-header">
        <span class="step-counter">Fase 04 / 04</span>
        <h2 class="step-title">Salud Mental</h2>
        <p class="step-desc">La salud mental es igual de importante que la física y también genera un deterioro en tu bienestar.</p>
      </div>

      <div class="input-group">
        <label>Nivel de Estrés Percibido</label>
        <div class="options-grid">
            <label class="option-card"><input type="radio" name="stress" value="0" checked><span class="card-content">Calma</span></label>
            <label class="option-card"><input type="radio" name="stress" value="1"><span class="card-content">Leve</span></label>
            <label class="option-card"><input type="radio" name="stress" value="2"><span class="card-content">Ansiedad</span></label>
            <label class="option-card"><input type="radio" name="stress" value="3"><span class="card-content">Pánico</span></label>
        </div>
      </div>

      <div class="input-group">
        <label>Presión Laboral</label>
        <div class="options-grid">
            <label class="option-card"><input type="radio" name="work" value="0" checked><span class="card-content">Baja</span></label>
            <label class="option-card"><input type="radio" name="work" value="1"><span class="card-content">Media</span></label>
            <label class="option-card"><input type="radio" name="work" value="2"><span class="card-content">Alta</span></label>
            <label class="option-card"><input type="radio" name="work" value="3"><span class="card-content">Extrema</span></label>
        </div>
      </div>
    </div>

  </div>

  <div class="wizard-nav">
    <button class="btn btn-prev" id="prevBtn" onclick="changeStep(-1)" disabled>Atrás</button>
    <button class="btn btn-next" id="nextBtn" onclick="changeStep(1)">Continuar</button>
  </div>
</div>

<div class="preview-area">
  <div class="preview-card" id="previewCard">
    <span class="glitch-wrapper" id="glitchText" data-text="TU NOMBRE">TU NOMBRE</span>
  </div>
</div>

<script>
/* --- LÓGICA DEL WIZARD (Pasos) --- */
let currentStep = 1;
const totalSteps = 4;

function changeStep(direction) {
    const newStep = currentStep + direction;
    if(newStep < 1 || newStep > totalSteps) return;
    document.getElementById(`step${currentStep}`).classList.remove('active');
    currentStep = newStep;
    document.getElementById(`step${currentStep}`).classList.add('active');
    const progress = (currentStep / totalSteps) * 100;
    document.getElementById('progressBar').style.width = `${progress}%`;
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    prevBtn.disabled = currentStep === 1;
    prevBtn.style.opacity = currentStep === 1 ? '0.5' : '1';
    if (currentStep === totalSteps) {
        nextBtn.textContent = "Finalizar";
        nextBtn.style.display = "none"; 
    } else {
        nextBtn.textContent = "Continuar";
        nextBtn.style.display = "block";
    }
}

/* --- LÓGICA DE TIPOGRAFÍA REACTIVA --- */
const glitchText = document.getElementById("glitchText");
const nameInput = document.getElementById("nameInput");
const citySelect = document.getElementById("citySelect");
const airQualityInfo = document.getElementById("airQualityInfo");

let degn = 0, sick = 0, mental = 0;
let airQualityValue = 0;

nameInput.addEventListener("input", () => {
  const newText = nameInput.value.toUpperCase() || "TU NOMBRE";
  glitchText.textContent = newText;
  glitchText.setAttribute('data-text', newText);
});

function getAirQualityForCity(cityName) {
  const [city] = cityName.split(',');
  const cityAirQuality = {
    'Madrid': { aqi: 48, label: 'Buena', value: 0 },
    'Barcelona': { aqi: 58, label: 'Moderada', value: 0.2 },
    'New York': { aqi: 68, label: 'Moderada', value: 0.2 },
    'Tokyo': { aqi: 58, label: 'Moderada', value: 0.2 },
    'Beijing': { aqi: 168, label: 'Mala', value: 0.5 },
    'Mumbai': { aqi: 195, label: 'Peligrosa', value: 0.8 },
    'Oslo': { aqi: 35, label: 'Excelente', value: 0 }
  };
  return cityAirQuality[city] || { aqi: 75, label: 'Moderada', value: 0.2 };
}

citySelect.addEventListener('change', () => {
  const cityValue = citySelect.value;
  if (!cityValue) {
    airQualityValue = 0;
    airQualityInfo.style.display = 'none';
    updateValues();
    return;
  }
  const airQuality = getAirQualityForCity(cityValue);
  airQualityValue = airQuality.value;
  airQualityInfo.textContent = `Calidad aire: ${airQuality.label}`;
  airQualityInfo.style.display = 'block';
  updateValues();
});

function updateValues() {
  const exercise = Number(document.querySelector('input[name="exercise"]:checked')?.value || 0);
  const sleep = Number(document.querySelector('input[name="sleep"]:checked')?.value || 0);
  const smoke = Number(document.querySelector('input[name="smoke"]:checked')?.value || 0);
  // CAMBIO: Dieta a 0 para que empiece limpia
  const diet = 0; 
  degn = exercise + diet + sleep + smoke;
  if (degn > 1000) degn = 1000;

  const temp = parseFloat(document.querySelector('input[name="temp"]:checked')?.value || 0);
  const water = parseFloat(document.querySelector('input[name="water"]:checked')?.value || 0);
  sick = (airQualityValue + temp + water); 
  if (sick > 1) sick = 1;

  const stress = Number(document.querySelector('input[name="stress"]:checked')?.value || 0);
  const work = Number(document.querySelector('input[name="work"]:checked')?.value || 0);
  mental = (stress + work) * 1.5;

  glitchText.style.fontVariationSettings = `"SICK" ${sick}, "DEGN" ${degn}`;
  updateGlitch();
}

function updateGlitch() {
  glitchText.classList.remove('glitch-level-1','glitch-level-2','glitch-level-3','active');
  if (mental === 0) return;
  else if (mental >= 1 && mental <= 3) glitchText.classList.add('glitch-level-1','active');
  else if (mental >= 4 && mental <= 6) glitchText.classList.add('glitch-level-2','active');
  else if (mental >= 7) glitchText.classList.add('glitch-level-3','active');
}

document.querySelectorAll('input, select').forEach(input => {
    input.addEventListener('change', updateValues);
});

updateValues();
</script>

</body>
</html>